{% extends "inicio.html" %}

{% block content %}
<!-- Mapa Neuronal Estratégico - Sistema Solar con Órbitas Concéntricas -->
<div class="mapa-neuronal-container" id="mapaFullscreen">
    <!-- Cabecera principal -->
    <div class="mapa-header-glass">
        <div class="header-content">
            <h1 class="mapa-title-glow">
                <i class="fas fa-solar-system"></i>
                <span class="title-text">SISTEMA SOLAR ESTRATÉGICO</span>
                <span class="subtitle">Proyecto El Domo</span>
            </h1>
            <div class="header-stats">
                <div class="stat-badge">
                    <i class="fas fa-sun"></i>
                    <span>1 Sol</span>
                </div>
                <div class="stat-badge">
                    <i class="fas fa-globe"></i>
                    <span id="total-ejes">7 Ejes</span>
                </div>
                <div class="stat-badge">
                    <i class="fas fa-moon"></i>
                    <span id="total-estrategias">0 Lunas</span>
                </div>
                <div class="stat-badge">
                    <i class="fas fa-satellite"></i>
                    <span id="total-tacticas">0 Satélites</span>
                </div>
                <div class="stat-badge">
                    <i class="fas fa-meteor"></i>
                    <span id="total-actividades">0 Asteroides</span>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Panel de controles -->
    <div class="panel-controles">
        <div class="grupo-controles">
            <h4><i class="fas fa-cogs"></i> Controles</h4>
            <div class="controles-grid">
                <button class="control-btn tooltip" onclick="toggleFullscreen()" data-tooltip="Pantalla completa">
                    <i class="fas fa-expand"></i>
                </button>
                <button class="control-btn tooltip" onclick="resetView()" data-tooltip="Reiniciar vista">
                    <i class="fas fa-sync-alt"></i>
                </button>
                <button class="control-btn tooltip" onclick="toggleAnimaciones()" data-tooltip="Animaciones">
                    <i class="fas fa-play" id="animacionIcon"></i>
                </button>
                <button class="control-btn tooltip" onclick="iniciarOrbitas()" data-tooltip="Iniciar órbitas">
                    <i class="fas fa-satellite"></i>
                </button>
            </div>
        </div>
    </div>
    
    <!-- Canvas principal -->
    <div class="mapa-canvas-fullscreen" id="mapaCanvas">
        <!-- Fondo estrellado -->
        <div class="estrellas-container" id="estrellasContainer"></div>
        
        <!-- Anillos orbitales (círculos concéntricos) -->
        <div class="anillos-orbitales" id="anillosOrbitales"></div>
        
        <!-- Contenedor del sistema solar -->
        <div class="sistema-solar" id="sistemaSolar">
            <!-- Sol Central -->
            <div class="orbita-sol" id="orbitaSol">
                <div class="nodo-sol" id="nodo-objetivo">
                    <div class="nodo-glow-sol"></div>
                    <div class="nodo-content">
                        <div class="nodo-icon-pulse-sol">
                            <i class="fas fa-sun"></i>
                        </div>
                        <div class="nodo-title-glow">OBJETIVO ESTRATÉGICO</div>
                        <button class="btn-ver-mas" onclick="mostrarDetalleObjetivo()">
                            <i class="fas fa-eye"></i> Ver completo
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Planetas (ejes) orbitando alrededor del sol -->
            <div class="ejes-orbitales" id="ejesOrbitales"></div>
            
            <!-- Estrategias (lunas) orbitando alrededor de los planetas -->
            <div class="estrategias-orbitales" id="estrategiasOrbitales"></div>
            
            <!-- Tácticas (satélites) orbitando alrededor de las lunas -->
            <div class="tacticas-orbitales" id="tacticasOrbitales"></div>
            
            <!-- Actividades (asteroides) orbitando alrededor de los satélites -->
            <div class="actividades-orbitales" id="actividadesOrbitales"></div>
        </div>
    </div>
    
    <!-- Panel de detalles -->
    <div class="panel-detalles" id="panelDetalles">
        <div class="panel-header">
            <h3 id="detalleTitulo"><i class="fas fa-info-circle"></i> Detalles</h3>
            <button class="panel-close" onclick="cerrarPanel()">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="panel-body" id="detalleContenido"></div>
    </div>
</div>

<style>
    /* ================================
       ESTILOS PRINCIPALES
    ================================ */
    
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }
    
    .mapa-neuronal-container {
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        background: linear-gradient(135deg, #000428 0%, #000e3b 50%, #001f5c 100%);
        overflow: hidden;
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
    
    /* Cabecera */
    .mapa-header-glass {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 80px;
        background: rgba(0, 0, 0, 0.3);
        backdrop-filter: blur(20px);
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        padding: 0 20px;
        z-index: 1000;
        display: flex;
        align-items: center;
    }
    
    .header-content {
        width: 100%;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }
    
    .mapa-title-glow {
        color: white;
        display: flex;
        flex-direction: column;
        gap: 5px;
    }
    
    .title-text {
        font-size: 22px;
        font-weight: 700;
        letter-spacing: 1px;
        text-shadow: 0 0 15px rgba(255, 215, 0, 0.7);
    }
    
    .subtitle {
        font-size: 14px;
        opacity: 0.8;
        font-weight: 400;
        color: rgba(255, 255, 255, 0.9);
    }
    
    .header-stats {
        display: flex;
        gap: 15px;
    }
    
    .stat-badge {
        background: rgba(255, 255, 255, 0.1);
        padding: 8px 15px;
        border-radius: 15px;
        display: flex;
        align-items: center;
        gap: 8px;
        color: white;
        font-size: 14px;
        border: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    /* Panel de controles */
    .panel-controles {
        position: absolute;
        top: 90px;
        right: 20px;
        width: 300px;
        background: rgba(0, 0, 0, 0.3);
        backdrop-filter: blur(20px);
        border-radius: 15px;
        padding: 20px;
        z-index: 1000;
        border: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .grupo-controles h4 {
        color: white;
        font-size: 14px;
        font-weight: 600;
        margin-bottom: 15px;
        display: flex;
        align-items: center;
        gap: 8px;
    }
    
    .controles-grid {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 8px;
    }
    
    .control-btn {
        width: 40px;
        height: 40px;
        border-radius: 10px;
        background: rgba(255, 215, 0, 0.2);
        border: 1px solid rgba(255, 215, 0, 0.3);
        color: white;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 16px;
        transition: all 0.3s ease;
    }
    
    .control-btn:hover {
        background: rgba(255, 215, 0, 0.4);
        transform: translateY(-2px);
    }
    
    .tooltip {
        position: relative;
    }
    
    .tooltip::after {
        content: attr(data-tooltip);
        position: absolute;
        bottom: 100%;
        left: 50%;
        transform: translateX(-50%);
        background: rgba(0, 0, 0, 0.8);
        color: white;
        padding: 6px 12px;
        border-radius: 6px;
        font-size: 12px;
        white-space: nowrap;
        opacity: 0;
        visibility: hidden;
        transition: all 0.3s ease;
        pointer-events: none;
    }
    
    .tooltip:hover::after {
        opacity: 1;
        visibility: visible;
        bottom: 120%;
    }
    
    /* Canvas principal */
    .mapa-canvas-fullscreen {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        overflow: hidden;
        z-index: 1;
    }
    
    /* Estrellas de fondo */
    .estrellas-container {
        position: absolute;
        width: 100%;
        height: 100%;
        pointer-events: none;
        z-index: 1;
    }
    
    .estrella {
        position: absolute;
        background: white;
        border-radius: 50%;
        animation: twinkle 3s infinite;
    }
    
    @keyframes twinkle {
        0%, 100% { opacity: 0.3; }
        50% { opacity: 1; }
    }
    
    /* Anillos orbitales concéntricos */
    .anillos-orbitales {
        position: absolute;
        width: 100%;
        height: 100%;
        pointer-events: none;
        z-index: 2;
    }
    
    .anillo-orbital {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        border: 1px solid rgba(255, 255, 255, 0.05);
        border-radius: 50%;
    }
    
    /* Sistema solar */
    .sistema-solar {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 100%;
        height: 100%;
        z-index: 10;
    }
    
    /* Sol */
    .orbita-sol {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 300px;
        height: 300px;
        z-index: 100;
    }
    
    .nodo-sol {
        width: 100%;
        height: 100%;
        position: relative;
    }
    
    .nodo-glow-sol {
        position: absolute;
        width: 100%;
        height: 100%;
        border-radius: 50%;
        background: radial-gradient(circle, 
            rgba(255, 215, 0, 0.6) 0%, 
            rgba(255, 140, 0, 0.3) 30%, 
            rgba(255, 140, 0, 0) 70%);
        animation: pulseSol 3s infinite;
        filter: blur(30px);
        z-index: -1;
    }
    
    .nodo-sol .nodo-content {
        position: relative;
        width: 100%;
        height: 100%;
        background: radial-gradient(circle, #FFD700, #FF8C00);
        border-radius: 50%;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        text-align: center;
        padding: 40px;
        border: 4px solid rgba(255, 255, 255, 0.3);
        box-shadow: 0 0 60px rgba(255, 215, 0, 0.7);
    }
    
    .nodo-icon-pulse-sol {
        width: 100px;
        height: 100px;
        background: rgba(255, 255, 255, 0.9);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-bottom: 20px;
        font-size: 48px;
        color: #FF8C00;
        animation: pulseSolIcon 2s infinite;
        box-shadow: 0 0 40px rgba(255, 215, 0, 0.8);
    }
    
    .nodo-title-glow {
        font-size: 18px;
        font-weight: 700;
        color: white;
        margin-bottom: 10px;
        text-transform: uppercase;
        letter-spacing: 1px;
        text-shadow: 0 0 10px rgba(255, 215, 0, 0.7);
    }
    
    .btn-ver-mas {
        background: linear-gradient(135deg, rgba(255, 255, 255, 0.9), rgba(255, 215, 0, 0.8));
        border: none;
        color: #000;
        padding: 10px 20px;
        border-radius: 25px;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 8px;
        font-size: 14px;
        font-weight: 600;
        transition: all 0.3s ease;
    }
    
    .btn-ver-mas:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 20px rgba(255, 215, 0, 0.4);
    }
    
    /* Contenedor de planetas (ejes) */
    .ejes-orbitales {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 2000px;
        height: 2000px;
        z-index: 90;
    }
    
    /* Planetas individuales */
    .planeta-orbita {
        position: absolute;
        top: 50%;
        left: 50%;
        transform-origin: center center;
        z-index: 90;
    }
    
    .nodo-eje {
        position: absolute;
        border-radius: 50%;
        cursor: pointer;
        transition: all 0.3s ease;
        z-index: 90;
    }
    
    .nodo-eje .nodo-content {
        position: relative;
        width: 100%;
        height: 100%;
        border-radius: 50%;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        text-align: center;
        padding: 20px;
        border: 3px solid rgba(255, 255, 255, 0.3);
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3),
                    inset 0 0 20px rgba(255, 255, 255, 0.1);
        transition: all 0.3s ease;
    }
    
    .nodo-eje:hover .nodo-content {
        transform: scale(1.1);
        box-shadow: 0 15px 40px rgba(0, 0, 0, 0.4),
                    inset 0 0 30px rgba(255, 255, 255, 0.2);
    }
    
    .nodo-eje .nodo-icon {
        width: 50px;
        height: 50px;
        background: rgba(255, 255, 255, 0.9);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-bottom: 10px;
        font-size: 20px;
        color: #2980b9;
        box-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
    }
    
    .nodo-eje .nodo-title {
        font-size: 12px;
        font-weight: 600;
        color: white;
        text-align: center;
        line-height: 1.2;
    }
    
    /* Órbitas de estrategias (lunas) */
    .estrategias-orbitales {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 2000px;
        height: 2000px;
        z-index: 80;
    }
    
    .orbita-estrategia {
        position: absolute;
        transform-origin: center center;
        z-index: 80;
    }
    
    .nodo-estrategia {
        position: absolute;
        border-radius: 50%;
        cursor: pointer;
        z-index: 80;
    }
    
    .nodo-estrategia .nodo-content {
        background: radial-gradient(circle, rgba(46, 204, 113, 0.9), rgba(39, 174, 96, 0.8));
        border: 2px solid rgba(255, 255, 255, 0.3);
        padding: 15px;
    }
    
    .nodo-estrategia .nodo-icon {
        width: 30px;
        height: 30px;
        background: rgba(255, 255, 255, 0.9);
        color: #27ae60;
    }
    
    /* Órbitas de tácticas (satélites) */
    .tacticas-orbitales {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 2000px;
        height: 2000px;
        z-index: 70;
    }
    
    .orbita-tactica {
        position: absolute;
        transform-origin: center center;
        z-index: 70;
    }
    
    .nodo-tactica {
        position: absolute;
        border-radius: 50%;
        cursor: pointer;
        z-index: 70;
    }
    
    .nodo-tactica .nodo-content {
        background: radial-gradient(circle, rgba(231, 76, 60, 0.9), rgba(192, 57, 43, 0.8));
        border: 2px solid rgba(255, 255, 255, 0.3);
        padding: 10px;
    }
    
    .nodo-tactica .nodo-icon {
        width: 25px;
        height: 25px;
        background: rgba(255, 255, 255, 0.9);
        color: #c0392b;
    }
    
    /* Órbitas de actividades (asteroides) */
    .actividades-orbitales {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 2000px;
        height: 2000px;
        z-index: 60;
    }
    
    .orbita-actividad {
        position: absolute;
        transform-origin: center center;
        z-index: 60;
    }
    
    .nodo-actividad {
        position: absolute;
        border-radius: 50%;
        cursor: pointer;
        z-index: 60;
    }
    
    .nodo-actividad .nodo-content {
        background: radial-gradient(circle, rgba(243, 156, 18, 0.9), rgba(211, 84, 0, 0.8));
        border: 1px solid rgba(255, 255, 255, 0.3);
        padding: 8px;
    }
    
    .nodo-actividad .nodo-icon {
        width: 20px;
        height: 20px;
        background: rgba(255, 255, 255, 0.9);
        color: #d35400;
        border-radius: 50%;
    }
    
    /* Panel de detalles */
    .panel-detalles {
        position: fixed;
        top: 0;
        right: -400px;
        width: 380px;
        height: 100%;
        background: rgba(0, 0, 0, 0.3);
        backdrop-filter: blur(30px);
        border-left: 1px solid rgba(255, 255, 255, 0.1);
        z-index: 2000;
        transition: right 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        overflow-y: auto;
    }
    
    .panel-detalles.open {
        right: 0;
    }
    
    .panel-header {
        padding: 25px;
        background: rgba(0, 20, 60, 0.5);
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        display: flex;
        justify-content: space-between;
        align-items: center;
    }
    
    .panel-header h3 {
        color: white;
        font-size: 18px;
        font-weight: 600;
        display: flex;
        align-items: center;
        gap: 10px;
    }
    
    .panel-close {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background: rgba(255, 255, 255, 0.1);
        border: none;
        color: white;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.3s ease;
    }
    
    .panel-close:hover {
        background: rgba(255, 255, 255, 0.2);
        transform: rotate(90deg);
    }
    
    .panel-body {
        padding: 25px;
        color: rgba(255, 255, 255, 0.9);
    }
    
    /* Animaciones */
    @keyframes pulseSol {
        0%, 100% { opacity: 0.6; transform: scale(1); }
        50% { opacity: 0.8; transform: scale(1.05); }
    }
    
    @keyframes pulseSolIcon {
        0%, 100% { box-shadow: 0 0 40px rgba(255, 215, 0, 0.8); }
        50% { box-shadow: 0 0 60px rgba(255, 215, 0, 1); }
    }
    
    @keyframes orbitar {
        from { transform: rotate(0deg) translateX(var(--distancia)) rotate(0deg); }
        to { transform: rotate(360deg) translateX(var(--distancia)) rotate(-360deg); }
    }
    
    /* Colores específicos para cada eje */
    .eje-educacion .nodo-content { background: radial-gradient(circle, #3498db, #2980b9) !important; }
    .eje-salud .nodo-content { background: radial-gradient(circle, #e74c3c, #c0392b) !important; }
    .eje-empleabilidad .nodo-content { background: radial-gradient(circle, #2ecc71, #27ae60) !important; }
    .eje-desarrollo_economico .nodo-content { background: radial-gradient(circle, #9b59b6, #8e44ad) !important; }
    .eje-sostenibilidad_ambiental .nodo-content { background: radial-gradient(circle, #1abc9c, #16a085) !important; }
    .eje-comunicacion .nodo-content { background: radial-gradient(circle, #f1c40f, #f39c12) !important; }
    .eje-institucional .nodo-content { background: radial-gradient(circle, #e67e22, #d35400) !important; }
    
    .eje-educacion .nodo-icon { color: #2980b9 !important; }
    .eje-salud .nodo-icon { color: #c0392b !important; }
    .eje-empleabilidad .nodo-icon { color: #27ae60 !important; }
    .eje-desarrollo_economico .nodo-icon { color: #8e44ad !important; }
    .eje-sostenibilidad_ambiental .nodo-icon { color: #16a085 !important; }
    .eje-comunicacion .nodo-icon { color: #f39c12 !important; }
    .eje-institucional .nodo-icon { color: #d35400 !important; }
</style>

<script>
// ================================
// SISTEMA SOLAR CON ÓRBITAS CONCÉNTRICAS
// ================================

const SISTEMA_SOLAR = {
    ejes: [],
    estrategias: [],
    tacticas: [],
    actividades: [],
    animacionesActivas: true
};

// Configuración orbital - radios concéntricos
const CONFIG_ORBITAS = {
    // Radios orbitales para cada planeta (distancias desde el sol)
    radiosPlanetas: [400, 500, 600, 700, 800, 900, 1000],
    
    // Velocidades orbitales (más lento para planetas más lejanos)
    velocidadesPlanetas: [0.8, 0.6, 0.5, 0.4, 0.35, 0.3, 0.25],
    
    // Tamaños de planetas (más pequeños los más lejanos)
    tamanosPlanetas: [120, 110, 100, 90, 85, 80, 75],
    
    // Radios para órbitas secundarias
    radioLuna: 80,
    radioSatelite: 50,
    radioAsteroide: 30
};

// ================================
// INICIALIZACIÓN
// ================================

document.addEventListener('DOMContentLoaded', function() {
    inicializarSistema();
    crearEstrellas();
    crearAnillosOrbitales();
    crearEjes();
    cargarDatosEjemplo();
});

function inicializarSistema() {
    const sistemaSolar = document.getElementById('sistemaSolar');
    const canvas = document.getElementById('mapaCanvas');
    const canvasRect = canvas.getBoundingClientRect();
    
    sistemaSolar.style.width = `${canvasRect.width}px`;
    sistemaSolar.style.height = `${canvasRect.height}px`;
}

function crearEstrellas() {
    const container = document.getElementById('estrellasContainer');
    const cantidad = 200;
    
    for (let i = 0; i < cantidad; i++) {
        const estrella = document.createElement('div');
        estrella.className = 'estrella';
        
        const x = Math.random() * 100;
        const y = Math.random() * 100;
        const size = Math.random() * 2 + 1;
        const duracion = Math.random() * 5 + 2;
        const delay = Math.random() * 5;
        
        estrella.style.left = `${x}%`;
        estrella.style.top = `${y}%`;
        estrella.style.width = `${size}px`;
        estrella.style.height = `${size}px`;
        estrella.style.animation = `twinkle ${duracion}s infinite ${delay}s`;
        estrella.style.opacity = Math.random() * 0.5 + 0.3;
        
        container.appendChild(estrella);
    }
}

function crearAnillosOrbitales() {
    const container = document.getElementById('anillosOrbitales');
    container.innerHTML = '';
    
    const sistemaSolar = document.getElementById('sistemaSolar');
    const sistemaRect = sistemaSolar.getBoundingClientRect();
    const centroX = sistemaRect.width / 2;
    const centroY = sistemaRect.height / 2;
    
    // Crear anillos concéntricos para cada órbita de planeta
    CONFIG_ORBITAS.radiosPlanetas.forEach((radio, index) => {
        const anillo = document.createElement('div');
        anillo.className = 'anillo-orbital';
        
        anillo.style.cssText = `
            width: ${radio * 2}px;
            height: ${radio * 2}px;
            top: ${centroY}px;
            left: ${centroX}px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.05);
            z-index: 2;
        `;
        
        container.appendChild(anillo);
    });
}

function crearEjes() {
    const container = document.getElementById('ejesOrbitales');
    container.innerHTML = '';
    
    const sistemaSolar = document.getElementById('sistemaSolar');
    const sistemaRect = sistemaSolar.getBoundingClientRect();
    const centroX = sistemaRect.width / 2;
    const centroY = sistemaRect.height / 2;
    
    // Definir ejes estratégicos (planetas)
    SISTEMA_SOLAR.ejes = [
        {
            id: 'educacion',
            nombre: 'EDUCACIÓN',
            icono: 'graduation-cap',
            color: '#3498db',
            descripcion: 'Mejora de infraestructura educativa y capacitación docente',
            distancia: CONFIG_ORBITAS.radiosPlanetas[0],
            velocidad: CONFIG_ORBITAS.velocidadesPlanetas[0],
            tamano: CONFIG_ORBITAS.tamanosPlanetas[0],
            anguloInicial: 0
        },
        {
            id: 'salud',
            nombre: 'SALUD',
            icono: 'heartbeat',
            color: '#e74c3c',
            descripcion: 'Equipamiento médico y mejoras en servicios de salud',
            distancia: CONFIG_ORBITAS.radiosPlanetas[1],
            velocidad: CONFIG_ORBITAS.velocidadesPlanetas[1],
            tamano: CONFIG_ORBITAS.tamanosPlanetas[1],
            anguloInicial: 51.4
        },
        {
            id: 'empleabilidad',
            nombre: 'EMPLEABILIDAD',
            icono: 'briefcase',
            color: '#2ecc71',
            descripcion: 'Formación técnica y oportunidades de empleo local',
            distancia: CONFIG_ORBITAS.radiosPlanetas[2],
            velocidad: CONFIG_ORBITAS.velocidadesPlanetas[2],
            tamano: CONFIG_ORBITAS.tamanosPlanetas[2],
            anguloInicial: 102.8
        },
        {
            id: 'desarrollo_economico',
            nombre: 'DESARROLLO ECONÓMICO',
            icono: 'chart-line',
            color: '#9b59b6',
            descripcion: 'Impulso al desarrollo económico comunitario',
            distancia: CONFIG_ORBITAS.radiosPlanetas[3],
            velocidad: CONFIG_ORBITAS.velocidadesPlanetas[3],
            tamano: CONFIG_ORBITAS.tamanosPlanetas[3],
            anguloInicial: 154.2
        },
        {
            id: 'sostenibilidad_ambiental',
            nombre: 'SOSTENIBILIDAD AMBIENTAL',
            icono: 'tint',
            color: '#1abc9c',
            descripcion: 'Gestión sostenible del recurso hídrico y monitoreo ambiental',
            distancia: CONFIG_ORBITAS.radiosPlanetas[4],
            velocidad: CONFIG_ORBITAS.velocidadesPlanetas[4],
            tamano: CONFIG_ORBITAS.tamanosPlanetas[4],
            anguloInicial: 205.6
        },
        {
            id: 'comunicacion',
            nombre: 'COMUNICACIÓN',
            icono: 'bullhorn',
            color: '#f1c40f',
            descripcion: 'Sistema de comunicación comunitaria y transparencia',
            distancia: CONFIG_ORBITAS.radiosPlanetas[5],
            velocidad: CONFIG_ORBITAS.velocidadesPlanetas[5],
            tamano: CONFIG_ORBITAS.tamanosPlanetas[5],
            anguloInicial: 257
        },
        {
            id: 'institucional',
            nombre: 'INSTITUCIONAL',
            icono: 'landmark',
            color: '#e67e22',
            descripcion: 'Cooperación técnica con GADs y niveles distritales',
            distancia: CONFIG_ORBITAS.radiosPlanetas[6],
            velocidad: CONFIG_ORBITAS.velocidadesPlanetas[6],
            tamano: CONFIG_ORBITAS.tamanosPlanetas[6],
            anguloInicial: 308.4
        }
    ];
    
    // Crear cada planeta en su órbita concéntrica
    SISTEMA_SOLAR.ejes.forEach((eje, index) => {
        // Crear contenedor de órbita para el planeta
        const orbitaDiv = document.createElement('div');
        orbitaDiv.className = 'planeta-orbita';
        orbitaDiv.id = `orbita-${eje.id}`;
        orbitaDiv.dataset.ejeId = eje.id;
        orbitaDiv.dataset.distancia = eje.distancia;
        
        // Posicionar la órbita
        orbitaDiv.style.cssText = `
            top: ${centroY}px;
            left: ${centroX}px;
            width: ${eje.distancia * 2}px;
            height: ${eje.distancia * 2}px;
            transform: rotate(${eje.anguloInicial}deg);
            z-index: ${90 + index};
        `;
        
        // Crear el planeta
        const planetaDiv = document.createElement('div');
        planetaDiv.className = `nodo nodo-eje eje-${eje.id} planeta-${eje.id}`;
        planetaDiv.id = `eje-${eje.id}`;
        planetaDiv.dataset.ejeId = eje.id;
        planetaDiv.dataset.tipo = 'eje';
        planetaDiv.dataset.velocidad = eje.velocidad;
        planetaDiv.dataset.angulo = eje.anguloInicial;
        
        // Tamaño y posición del planeta
        planetaDiv.style.cssText = `
            position: absolute;
            top: 0;
            left: ${eje.distancia}px;
            width: ${eje.tamano}px;
            height: ${eje.tamano}px;
            transform: translate(-50%, -50%);
            z-index: ${91 + index};
        `;
        
        planetaDiv.innerHTML = `
            <div class="nodo-content">
                <div class="nodo-icon">
                    <i class="fas fa-${eje.icono}"></i>
                </div>
                <div class="nodo-title">${eje.nombre}</div>
            </div>
        `;
        
        // Eventos
        planetaDiv.addEventListener('click', function(e) {
            e.stopPropagation();
            mostrarDetallesEje(eje.id);
        });
        
        // Añadir planeta a la órbita
        orbitaDiv.appendChild(planetaDiv);
        container.appendChild(orbitaDiv);
        
        // Iniciar animación de órbita
        if (SISTEMA_SOLAR.animacionesActivas) {
            animarPlaneta(planetaDiv, orbitaDiv, eje);
        }
    });
    
    // Actualizar contador
    document.getElementById('total-ejes').textContent = `${SISTEMA_SOLAR.ejes.length} Ejes`;
}

function animarPlaneta(planetaDiv, orbitaDiv, eje) {
    let angulo = parseFloat(planetaDiv.dataset.angulo) || 0;
    const velocidad = parseFloat(planetaDiv.dataset.velocidad) || 0.5;
    const distancia = eje.distancia;
    
    function actualizarPosicion() {
        if (!SISTEMA_SOLAR.animacionesActivas) return;
        
        // Incrementar ángulo
        angulo += velocidad * 0.1;
        if (angulo >= 360) angulo = 0;
        
        // Actualizar rotación de la órbita
        orbitaDiv.style.transform = `rotate(${angulo}deg)`;
        
        // Guardar ángulo actual
        planetaDiv.dataset.angulo = angulo;
        
        // Continuar animación
        requestAnimationFrame(actualizarPosicion);
    }
    
    // Iniciar animación
    requestAnimationFrame(actualizarPosicion);
}

function iniciarOrbitasPlanetas() {
    SISTEMA_SOLAR.animacionesActivas = true;
    
    // Iniciar animación para cada planeta
    document.querySelectorAll('.nodo-eje').forEach(planeta => {
        const ejeId = planeta.dataset.ejeId;
        const eje = SISTEMA_SOLAR.ejes.find(e => e.id === ejeId);
        const orbitaDiv = document.getElementById(`orbita-${ejeId}`);
        
        if (eje && orbitaDiv) {
            animarPlaneta(planeta, orbitaDiv, eje);
        }
    });
    
    // Iniciar órbitas secundarias
    iniciarOrbitasSecundarias();
}

function iniciarOrbitasSecundarias() {
    // Iniciar animación para lunas
    document.querySelectorAll('.nodo-estrategia').forEach(luna => {
        const estrategiaId = luna.dataset.estrategiaId;
        const estrategia = SISTEMA_SOLAR.estrategias.find(e => e.id == estrategiaId);
        if (estrategia) {
            animarLuna(luna, estrategia);
        }
    });
    
    // Iniciar animación para satélites
    document.querySelectorAll('.nodo-tactica').forEach(satelite => {
        const tacticaId = satelite.dataset.tacticaId;
        const tactica = SISTEMA_SOLAR.tacticas.find(t => t.id == tacticaId);
        if (tactica) {
            animarSatelite(satelite, tactica);
        }
    });
    
    // Iniciar animación para asteroides
    document.querySelectorAll('.nodo-actividad').forEach(asteroide => {
        const actividadId = asteroide.dataset.actividadId;
        const actividad = SISTEMA_SOLAR.actividades.find(a => a.id == actividadId);
        if (actividad) {
            animarAsteroide(asteroide, actividad);
        }
    });
}

function animarLuna(lunaDiv, estrategia) {
    let angulo = 0;
    const velocidad = 1.2;
    
    function actualizarPosicion() {
        if (!SISTEMA_SOLAR.animacionesActivas) return;
        
        angulo += velocidad * 0.1;
        if (angulo >= 360) angulo = 0;
        
        // Calcular posición en órbita circular
        const x = CONFIG_ORBITAS.radioLuna * Math.cos(angulo * Math.PI / 180);
        const y = CONFIG_ORBITAS.radioLuna * Math.sin(angulo * Math.PI / 180);
        
        lunaDiv.style.transform = `translate(${x}px, ${y}px)`;
        
        requestAnimationFrame(actualizarPosicion);
    }
    
    requestAnimationFrame(actualizarPosicion);
}

function animarSatelite(sateliteDiv, tactica) {
    let angulo = 0;
    const velocidad = 1.8;
    
    function actualizarPosicion() {
        if (!SISTEMA_SOLAR.animacionesActivas) return;
        
        angulo += velocidad * 0.1;
        if (angulo >= 360) angulo = 0;
        
        const x = CONFIG_ORBITAS.radioSatelite * Math.cos(angulo * Math.PI / 180);
        const y = CONFIG_ORBITAS.radioSatelite * Math.sin(angulo * Math.PI / 180);
        
        sateliteDiv.style.transform = `translate(${x}px, ${y}px)`;
        
        requestAnimationFrame(actualizarPosicion);
    }
    
    requestAnimationFrame(actualizarPosicion);
}

function animarAsteroide(asteroideDiv, actividad) {
    let angulo = 0;
    const velocidad = 2.5;
    
    function actualizarPosicion() {
        if (!SISTEMA_SOLAR.animacionesActivas) return;
        
        angulo += velocidad * 0.1;
        if (angulo >= 360) angulo = 0;
        
        const x = CONFIG_ORBITAS.radioAsteroide * Math.cos(angulo * Math.PI / 180);
        const y = CONFIG_ORBITAS.radioAsteroide * Math.sin(angulo * Math.PI / 180);
        
        asteroideDiv.style.transform = `translate(${x}px, ${y}px)`;
        
        requestAnimationFrame(actualizarPosicion);
    }
    
    requestAnimationFrame(actualizarPosicion);
}

function cargarDatosEjemplo() {
    // Estrategias de ejemplo
    SISTEMA_SOLAR.estrategias = [
        { id: 1, eje_id: 'educacion', nombre: 'Capacitación docente', tipo: 'FO' },
        { id: 2, eje_id: 'educacion', nombre: 'Infraestructura educativa', tipo: 'DO' },
        { id: 3, eje_id: 'salud', nombre: 'Equipamiento médico', tipo: 'FO' },
        { id: 4, eje_id: 'empleabilidad', nombre: 'Formación técnica', tipo: 'FA' },
        { id: 5, eje_id: 'sostenibilidad_ambiental', nombre: 'Monitoreo ambiental', tipo: 'DO' }
    ];
    
    // Tácticas de ejemplo
    SISTEMA_SOLAR.tacticas = [
        { id: 1, estrategia_id: 1, nombre: 'Talleres de capacitación' },
        { id: 2, estrategia_id: 1, nombre: 'Actualización curricular' },
        { id: 3, estrategia_id: 2, nombre: 'Construcción de aulas' },
        { id: 4, estrategia_id: 3, nombre: 'Adquisición de equipos' },
        { id: 5, estrategia_id: 4, nombre: 'Cursos técnicos' }
    ];
    
    // Actividades de ejemplo
    SISTEMA_SOLAR.actividades = [
        { id: 1, tactica_id: 1, nombre: 'Organizar taller', estado: 'completada' },
        { id: 2, tactica_id: 1, nombre: 'Evaluar participantes', estado: 'en_progreso' },
        { id: 3, tactica_id: 2, nombre: 'Revisar currículo', estado: 'pendiente' },
        { id: 4, tactica_id: 3, nombre: 'Elaborar planos', estado: 'completada' },
        { id: 5, tactica_id: 4, nombre: 'Cotizar equipos', estado: 'en_progreso' }
    ];
    
    crearEstrategias();
}

function crearEstrategias() {
    const container = document.getElementById('estrategiasOrbitales');
    container.innerHTML = '';
    
    SISTEMA_SOLAR.estrategias.forEach((estrategia, index) => {
        const eje = SISTEMA_SOLAR.ejes.find(e => e.id === estrategia.eje_id);
        if (!eje) return;
        
        const ejeElement = document.getElementById(`eje-${eje.id}`);
        if (!ejeElement) return;
        
        // Obtener posición del planeta
        const planetaRect = ejeElement.getBoundingClientRect();
        const sistemaRect = document.getElementById('sistemaSolar').getBoundingClientRect();
        
        const centroX = planetaRect.left + planetaRect.width / 2 - sistemaRect.left;
        const centroY = planetaRect.top + planetaRect.height / 2 - sistemaRect.top;
        
        // Crear contenedor de órbita para la luna
        const orbitaDiv = document.createElement('div');
        orbitaDiv.className = 'orbita-estrategia';
        orbitaDiv.id = `orbita-estrategia-${estrategia.id}`;
        orbitaDiv.dataset.estrategiaId = estrategia.id;
        
        // Posicionar la órbita de la luna
        orbitaDiv.style.cssText = `
            top: ${centroY}px;
            left: ${centroX}px;
            width: ${CONFIG_ORBITAS.radioLuna * 2}px;
            height: ${CONFIG_ORBITAS.radioLuna * 2}px;
            transform: rotate(${index * 72}deg);
            z-index: 80;
        `;
        
        // Crear la luna (estrategia)
        const lunaDiv = document.createElement('div');
        lunaDiv.className = 'nodo nodo-estrategia';
        lunaDiv.id = `estrategia-${estrategia.id}`;
        lunaDiv.dataset.estrategiaId = estrategia.id;
        lunaDiv.dataset.tipo = 'estrategia';
        
        // Posicionar la luna en la órbita
        lunaDiv.style.cssText = `
            top: 0;
            left: ${CONFIG_ORBITAS.radioLuna}px;
            width: 80px;
            height: 80px;
            transform: translate(-50%, -50%);
        `;
        
        lunaDiv.innerHTML = `
            <div class="nodo-content">
                <div class="nodo-icon">
                    <i class="fas fa-moon"></i>
                </div>
                <div class="nodo-title">${estrategia.nombre.substring(0, 15)}</div>
            </div>
        `;
        
        // Eventos
        lunaDiv.addEventListener('click', function(e) {
            e.stopPropagation();
            mostrarDetallesEstrategia(estrategia.id);
        });
        
        // Añadir a la órbita
        orbitaDiv.appendChild(lunaDiv);
        container.appendChild(orbitaDiv);
        
        // Iniciar animación de la luna
        if (SISTEMA_SOLAR.animacionesActivas) {
            animarLuna(lunaDiv, estrategia);
        }
    });
    
    // Actualizar contador
    document.getElementById('total-estrategias').textContent = `${SISTEMA_SOLAR.estrategias.length} Lunas`;
    
    crearTacticas();
}

function crearTacticas() {
    const container = document.getElementById('tacticasOrbitales');
    container.innerHTML = '';
    
    SISTEMA_SOLAR.tacticas.forEach((tactica, index) => {
        const estrategia = SISTEMA_SOLAR.estrategias.find(e => e.id === tactica.estrategia_id);
        if (!estrategia) return;
        
        const estrategiaElement = document.getElementById(`estrategia-${estrategia.id}`);
        if (!estrategiaElement) return;
        
        // Obtener posición de la luna
        const lunaRect = estrategiaElement.getBoundingClientRect();
        const sistemaRect = document.getElementById('sistemaSolar').getBoundingClientRect();
        
        const centroX = lunaRect.left + lunaRect.width / 2 - sistemaRect.left;
        const centroY = lunaRect.top + lunaRect.height / 2 - sistemaRect.top;
        
        // Crear contenedor de órbita para el satélite
        const orbitaDiv = document.createElement('div');
        orbitaDiv.className = 'orbita-tactica';
        orbitaDiv.id = `orbita-tactica-${tactica.id}`;
        orbitaDiv.dataset.tacticaId = tactica.id;
        
        // Posicionar la órbita del satélite
        orbitaDiv.style.cssText = `
            top: ${centroY}px;
            left: ${centroX}px;
            width: ${CONFIG_ORBITAS.radioSatelite * 2}px;
            height: ${CONFIG_ORBITAS.radioSatelite * 2}px;
            transform: rotate(${index * 90}deg);
            z-index: 70;
        `;
        
        // Crear el satélite (táctica)
        const sateliteDiv = document.createElement('div');
        sateliteDiv.className = 'nodo nodo-tactica';
        sateliteDiv.id = `tactica-${tactica.id}`;
        sateliteDiv.dataset.tacticaId = tactica.id;
        sateliteDiv.dataset.tipo = 'tactica';
        
        // Posicionar el satélite en la órbita
        sateliteDiv.style.cssText = `
            top: 0;
            left: ${CONFIG_ORBITAS.radioSatelite}px;
            width: 60px;
            height: 60px;
            transform: translate(-50%, -50%);
        `;
        
        sateliteDiv.innerHTML = `
            <div class="nodo-content">
                <div class="nodo-icon">
                    <i class="fas fa-satellite"></i>
                </div>
                <div class="nodo-title">${tactica.nombre.substring(0, 10)}</div>
            </div>
        `;
        
        // Eventos
        sateliteDiv.addEventListener('click', function(e) {
            e.stopPropagation();
            mostrarDetallesTactica(tactica.id);
        });
        
        // Añadir a la órbita
        orbitaDiv.appendChild(sateliteDiv);
        container.appendChild(orbitaDiv);
        
        // Iniciar animación del satélite
        if (SISTEMA_SOLAR.animacionesActivas) {
            animarSatelite(sateliteDiv, tactica);
        }
    });
    
    // Actualizar contador
    document.getElementById('total-tacticas').textContent = `${SISTEMA_SOLAR.tacticas.length} Satélites`;
    
    crearActividades();
}

function crearActividades() {
    const container = document.getElementById('actividadesOrbitales');
    container.innerHTML = '';
    
    SISTEMA_SOLAR.actividades.forEach((actividad, index) => {
        const tactica = SISTEMA_SOLAR.tacticas.find(t => t.id === actividad.tactica_id);
        if (!tactica) return;
        
        const tacticaElement = document.getElementById(`tactica-${tactica.id}`);
        if (!tacticaElement) return;
        
        // Obtener posición del satélite
        const sateliteRect = tacticaElement.getBoundingClientRect();
        const sistemaRect = document.getElementById('sistemaSolar').getBoundingClientRect();
        
        const centroX = sateliteRect.left + sateliteRect.width / 2 - sistemaRect.left;
        const centroY = sateliteRect.top + sateliteRect.height / 2 - sistemaRect.top;
        
        // Crear contenedor de órbita para el asteroide
        const orbitaDiv = document.createElement('div');
        orbitaDiv.className = 'orbita-actividad';
        orbitaDiv.id = `orbita-actividad-${actividad.id}`;
        orbitaDiv.dataset.actividadId = actividad.id;
        
        // Posicionar la órbita del asteroide
        orbitaDiv.style.cssText = `
            top: ${centroY}px;
            left: ${centroX}px;
            width: ${CONFIG_ORBITAS.radioAsteroide * 2}px;
            height: ${CONFIG_ORBITAS.radioAsteroide * 2}px;
            transform: rotate(${index * 120}deg);
            z-index: 60;
        `;
        
        // Crear el asteroide (actividad)
        const asteroideDiv = document.createElement('div');
        asteroideDiv.className = 'nodo nodo-actividad';
        asteroideDiv.id = `actividad-${actividad.id}`;
        asteroideDiv.dataset.actividadId = actividad.id;
        asteroideDiv.dataset.tipo = 'actividad';
        
        // Determinar color según estado
        let colorEstado = '#f39c12';
        let iconoEstado = 'fa-clock';
        switch(actividad.estado) {
            case 'completada':
                colorEstado = '#2ecc71';
                iconoEstado = 'fa-check-circle';
                break;
            case 'en_progreso':
                colorEstado = '#3498db';
                iconoEstado = 'fa-spinner';
                break;
        }
        
        // Posicionar el asteroide en la órbita
        asteroideDiv.style.cssText = `
            top: 0;
            left: ${CONFIG_ORBITAS.radioAsteroide}px;
            width: 40px;
            height: 40px;
            transform: translate(-50%, -50%);
        `;
        
        asteroideDiv.innerHTML = `
            <div class="nodo-content" style="background: radial-gradient(circle, ${colorEstado}, ${oscurecerColor(colorEstado, 20)})">
                <div class="nodo-icon" style="background: rgba(255,255,255,0.9); color: ${colorEstado}">
                    <i class="fas ${iconoEstado}"></i>
                </div>
                <div class="nodo-title">${actividad.nombre.substring(0, 8)}</div>
            </div>
        `;
        
        // Eventos
        asteroideDiv.addEventListener('click', function(e) {
            e.stopPropagation();
            mostrarDetallesActividad(actividad.id);
        });
        
        // Añadir a la órbita
        orbitaDiv.appendChild(asteroideDiv);
        container.appendChild(orbitaDiv);
        
        // Iniciar animación del asteroide
        if (SISTEMA_SOLAR.animacionesActivas) {
            animarAsteroide(asteroideDiv, actividad);
        }
    });
    
    // Actualizar contador
    document.getElementById('total-actividades').textContent = `${SISTEMA_SOLAR.actividades.length} Asteroides`;
}

// ================================
// FUNCIONES DE CONTROL
// ================================

function toggleFullscreen() {
    const container = document.getElementById('mapaFullscreen');
    
    if (!document.fullscreenElement) {
        container.requestFullscreen().catch(err => {
            console.log(`Error al activar pantalla completa: ${err.message}`);
        });
    } else {
        document.exitFullscreen();
    }
}

function resetView() {
    // Centrar la vista
    const sistemaSolar = document.getElementById('sistemaSolar');
    sistemaSolar.style.transform = 'translate(-50%, -50%) scale(1)';
    
    // Resetear ángulos de planetas
    SISTEMA_SOLAR.ejes.forEach((eje, index) => {
        const planeta = document.getElementById(`eje-${eje.id}`);
        const orbita = document.getElementById(`orbita-${eje.id}`);
        
        if (planeta && orbita) {
            planeta.dataset.angulo = eje.anguloInicial;
            orbita.style.transform = `rotate(${eje.anguloInicial}deg)`;
        }
    });
}

function toggleAnimaciones() {
    SISTEMA_SOLAR.animacionesActivas = !SISTEMA_SOLAR.animacionesActivas;
    const icon = document.getElementById('animacionIcon');
    
    if (SISTEMA_SOLAR.animacionesActivas) {
        icon.className = 'fas fa-pause';
        iniciarOrbitas();
    } else {
        icon.className = 'fas fa-play';
    }
}

function iniciarOrbitas() {
    SISTEMA_SOLAR.animacionesActivas = true;
    iniciarOrbitasPlanetas();
    document.getElementById('animacionIcon').className = 'fas fa-pause';
}

// ================================
// FUNCIONES DE DETALLES
// ================================

function mostrarDetalleObjetivo() {
    const panel = document.getElementById('panelDetalles');
    const titulo = document.getElementById('detalleTitulo');
    const contenido = document.getElementById('detalleContenido');
    
    titulo.innerHTML = `<i class="fas fa-sun"></i> Objetivo Estratégico`;
    
    contenido.innerHTML = `
        <div class="detalle-sol">
            <div class="encabezado-detalle" style="background: linear-gradient(135deg, #FFD700, #FF8C00);">
                <div class="icono-grande">
                    <i class="fas fa-sun"></i>
                </div>
                <h3>OBJETIVO ESTRATÉGICO</h3>
                <p>Centro del Sistema Solar</p>
            </div>
            
            <div class="descripcion-objetivo">
                <p><strong>Consolidar la viabilidad y el respaldo social del Proyecto El Domo</strong> mediante un modelo de gestión integral que garantice la integridad y disponibilidad del recurso hídrico local, asegurando su no afectación por actividades mineras.</p>
                
                <div class="estadisticas-detalle">
                    <div class="estadistica-item">
                        <div class="estadistica-valor">${SISTEMA_SOLAR.ejes.length}</div>
                        <div class="estadistica-label">Ejes</div>
                    </div>
                    <div class="estadistica-item">
                        <div class="estadistica-valor">${SISTEMA_SOLAR.estrategias.length}</div>
                        <div class="estadistica-label">Estrategias</div>
                    </div>
                    <div class="estadistica-item">
                        <div class="estadistica-valor">${SISTEMA_SOLAR.tacticas.length}</div>
                        <div class="estadistica-label">Tácticas</div>
                    </div>
                    <div class="estadistica-item">
                        <div class="estadistica-valor">${SISTEMA_SOLAR.actividades.length}</div>
                        <div class="estadistica-label">Actividades</div>
                    </div>
                </div>
            </div>
        </div>
        
        <style>
            .encabezado-detalle {
                padding: 30px;
                border-radius: 15px;
                margin-bottom: 20px;
                text-align: center;
                color: white;
            }
            
            .icono-grande {
                width: 80px;
                height: 80px;
                background: rgba(255,255,255,0.2);
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                margin: 0 auto 15px;
                font-size: 32px;
            }
            
            .encabezado-detalle h3 {
                font-size: 24px;
                margin-bottom: 10px;
            }
            
            .encabezado-detalle p {
                opacity: 0.9;
                font-size: 14px;
            }
            
            .descripcion-objetivo {
                line-height: 1.6;
                color: rgba(255,255,255,0.9);
            }
            
            .descripcion-objetivo p {
                margin-bottom: 20px;
            }
            
            .estadisticas-detalle {
                display: grid;
                grid-template-columns: repeat(4, 1fr);
                gap: 15px;
                margin: 20px 0;
            }
            
            .estadistica-item {
                background: rgba(255,255,255,0.05);
                border-radius: 10px;
                padding: 15px;
                text-align: center;
            }
            
            .estadistica-valor {
                font-size: 28px;
                font-weight: bold;
                color: white;
                margin-bottom: 5px;
            }
            
            .estadistica-label {
                font-size: 12px;
                color: rgba(255,255,255,0.7);
                text-transform: uppercase;
                letter-spacing: 0.5px;
            }
        </style>
    `;
    
    panel.classList.add('open');
}

function mostrarDetallesEje(ejeId) {
    const eje = SISTEMA_SOLAR.ejes.find(e => e.id === ejeId);
    if (!eje) return;
    
    const estrategiasDelEje = SISTEMA_SOLAR.estrategias.filter(e => e.eje_id === ejeId);
    
    const panel = document.getElementById('panelDetalles');
    const titulo = document.getElementById('detalleTitulo');
    const contenido = document.getElementById('detalleContenido');
    
    titulo.innerHTML = `<i class="fas fa-${eje.icono}"></i> ${eje.nombre}`;
    
    contenido.innerHTML = `
        <div class="detalle-eje">
            <div class="encabezado-detalle" style="background: linear-gradient(135deg, ${eje.color}, ${oscurecerColor(eje.color, 20)});">
                <div class="icono-grande">
                    <i class="fas fa-${eje.icono}"></i>
                </div>
                <h3>${eje.nombre}</h3>
                <p>Eje Estratégico</p>
            </div>
            
            <div class="info-eje">
                <p><strong>Descripción:</strong> ${eje.descripcion}</p>
                
                <div class="parametros-orbitales">
                    <h4><i class="fas fa-satellite"></i> Parámetros Orbitales</h4>
                    <div class="parametros-grid">
                        <div class="parametro">
                            <div class="parametro-label">Distancia al Sol</div>
                            <div class="parametro-valor">${eje.distancia}px</div>
                        </div>
                        <div class="parametro">
                            <div class="parametro-label">Velocidad Orbital</div>
                            <div class="parametro-valor">${eje.velocidad}</div>
                        </div>
                        <div class="parametro">
                            <div class="parametro-label">Tamaño</div>
                            <div class="parametro-valor">${eje.tamano}px</div>
                        </div>
                        <div class="parametro">
                            <div class="parametro-label">Posición Inicial</div>
                            <div class="parametro-valor">${eje.anguloInicial}°</div>
                        </div>
                    </div>
                </div>
                
                <div class="estadisticas-detalle">
                    <div class="estadistica-item">
                        <div class="estadistica-valor">${estrategiasDelEje.length}</div>
                        <div class="estadistica-label">Estrategias</div>
                    </div>
                    <div class="estadistica-item">
                        <div class="estadistica-valor">${SISTEMA_SOLAR.tacticas.filter(t => estrategiasDelEje.find(e => e.id === t.estrategia_id)).length}</div>
                        <div class="estadistica-label">Tácticas</div>
                    </div>
                    <div class="estadistica-item">
                        <div class="estadistica-valor">${SISTEMA_SOLAR.actividades.filter(a => SISTEMA_SOLAR.tacticas.find(t => t.id === a.tactica_id && estrategiasDelEje.find(e => e.id === t.estrategia_id))).length}</div>
                        <div class="estadistica-label">Actividades</div>
                    </div>
                </div>
                
                ${estrategiasDelEje.length > 0 ? `
                    <h4><i class="fas fa-moon"></i> Estrategias</h4>
                    <div class="lista-elementos">
                        ${estrategiasDelEje.map(estrategia => `
                            <div class="item-elemento" onclick="mostrarDetallesEstrategia(${estrategia.id})">
                                <div class="item-icono" style="background: #2ecc71">
                                    <i class="fas fa-moon"></i>
                                </div>
                                <div class="item-info">
                                    <div class="item-titulo">${estrategia.nombre}</div>
                                    <div class="item-subtitulo">Tipo: ${estrategia.tipo}</div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                ` : ''}
            </div>
        </div>
        
        <style>
            .info-eje {
                line-height: 1.6;
                color: rgba(255,255,255,0.9);
            }
            
            .info-eje p {
                margin-bottom: 20px;
            }
            
            .info-eje h4 {
                color: white;
                margin: 25px 0 15px;
                display: flex;
                align-items: center;
                gap: 10px;
            }
            
            .parametros-orbitales {
                background: rgba(255,255,255,0.05);
                border-radius: 10px;
                padding: 15px;
                margin: 20px 0;
            }
            
            .parametros-grid {
                display: grid;
                grid-template-columns: repeat(2, 1fr);
                gap: 10px;
                margin-top: 10px;
            }
            
            .parametro {
                background: rgba(255,255,255,0.03);
                border-radius: 8px;
                padding: 10px;
            }
            
            .parametro-label {
                font-size: 11px;
                color: rgba(255,255,255,0.7);
                margin-bottom: 5px;
            }
            
            .parametro-valor {
                font-size: 16px;
                font-weight: bold;
                color: white;
            }
            
            .lista-elementos {
                margin-top: 10px;
            }
            
            .item-elemento {
                background: rgba(255,255,255,0.05);
                border-radius: 10px;
                padding: 15px;
                margin-bottom: 10px;
                display: flex;
                align-items: center;
                gap: 15px;
                cursor: pointer;
                transition: all 0.3s ease;
            }
            
            .item-elemento:hover {
                background: rgba(255,255,255,0.1);
                transform: translateX(5px);
            }
            
            .item-icono {
                width: 40px;
                height: 40px;
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                color: white;
                font-size: 18px;
            }
            
            .item-info {
                flex: 1;
            }
            
            .item-titulo {
                font-weight: 600;
                color: white;
                font-size: 14px;
            }
            
            .item-subtitulo {
                font-size: 12px;
                color: rgba(255,255,255,0.7);
                margin-top: 2px;
            }
        </style>
    `;
    
    panel.classList.add('open');
}

function mostrarDetallesEstrategia(estrategiaId) {
    const estrategia = SISTEMA_SOLAR.estrategias.find(e => e.id == estrategiaId);
    if (!estrategia) return;
    
    const eje = SISTEMA_SOLAR.ejes.find(e => e.id === estrategia.eje_id);
    const tacticasDeEstrategia = SISTEMA_SOLAR.tacticas.filter(t => t.estrategia_id == estrategiaId);
    
    const panel = document.getElementById('panelDetalles');
    const titulo = document.getElementById('detalleTitulo');
    const contenido = document.getElementById('detalleContenido');
    
    titulo.innerHTML = `<i class="fas fa-moon"></i> ${estrategia.nombre}`;
    
    contenido.innerHTML = `
        <div class="detalle-estrategia">
            <div class="encabezado-detalle" style="background: linear-gradient(135deg, #2ecc71, #27ae60);">
                <div class="icono-grande">
                    <i class="fas fa-moon"></i>
                </div>
                <h3>${estrategia.nombre}</h3>
                <p>Estrategia - ${eje ? eje.nombre : 'Sin eje'}</p>
            </div>
            
            <div class="info-estrategia">
                <p><strong>Tipo:</strong> ${estrategia.tipo}</p>
                <p><strong>Eje:</strong> ${eje ? eje.nombre : 'No asignado'}</p>
                
                <div class="estadisticas-detalle">
                    <div class="estadistica-item">
                        <div class="estadistica-valor">${tacticasDeEstrategia.length}</div>
                        <div class="estadistica-label">Tácticas</div>
                    </div>
                    <div class="estadistica-item">
                        <div class="estadistica-valor">${SISTEMA_SOLAR.actividades.filter(a => tacticasDeEstrategia.find(t => t.id === a.tactica_id)).length}</div>
                        <div class="estadistica-label">Actividades</div>
                    </div>
                </div>
                
                ${tacticasDeEstrategia.length > 0 ? `
                    <h4><i class="fas fa-satellite"></i> Tácticas</h4>
                    <div class="lista-elementos">
                        ${tacticasDeEstrategia.map(tactica => `
                            <div class="item-elemento" onclick="mostrarDetallesTactica(${tactica.id})">
                                <div class="item-icono" style="background: #e74c3c">
                                    <i class="fas fa-satellite"></i>
                                </div>
                                <div class="item-info">
                                    <div class="item-titulo">${tactica.nombre}</div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                ` : ''}
            </div>
        </div>
        
        <style>
            .info-estrategia {
                line-height: 1.6;
                color: rgba(255,255,255,0.9);
            }
            
            .info-estrategia p {
                margin-bottom: 15px;
            }
        </style>
    `;
    
    panel.classList.add('open');
}

function mostrarDetallesTactica(tacticaId) {
    const tactica = SISTEMA_SOLAR.tacticas.find(t => t.id == tacticaId);
    if (!tactica) return;
    
    const estrategia = SISTEMA_SOLAR.estrategias.find(e => e.id == tactica.estrategia_id);
    const actividadesDeTactica = SISTEMA_SOLAR.actividades.filter(a => a.tactica_id == tacticaId);
    
    const panel = document.getElementById('panelDetalles');
    const titulo = document.getElementById('detalleTitulo');
    const contenido = document.getElementById('detalleContenido');
    
    titulo.innerHTML = `<i class="fas fa-satellite"></i> ${tactica.nombre}`;
    
    contenido.innerHTML = `
        <div class="detalle-tactica">
            <div class="encabezado-detalle" style="background: linear-gradient(135deg, #e74c3c, #c0392b);">
                <div class="icono-grande">
                    <i class="fas fa-satellite"></i>
                </div>
                <h3>${tactica.nombre}</h3>
                <p>Táctica</p>
            </div>
            
            <div class="info-tactica">
                <p><strong>Estrategia:</strong> ${estrategia ? estrategia.nombre : 'No asignada'}</p>
                
                <div class="estadisticas-detalle">
                    <div class="estadistica-item">
                        <div class="estadistica-valor">${actividadesDeTactica.length}</div>
                        <div class="estadistica-label">Actividades</div>
                    </div>
                    <div class="estadistica-item">
                        <div class="estadistica-valor">${actividadesDeTactica.filter(a => a.estado === 'completada').length}</div>
                        <div class="estadistica-label">Completadas</div>
                    </div>
                </div>
                
                ${actividadesDeTactica.length > 0 ? `
                    <h4><i class="fas fa-meteor"></i> Actividades</h4>
                    <div class="lista-elementos">
                        ${actividadesDeTactica.map(actividad => {
                            let colorEstado = '#f39c12';
                            let iconoEstado = 'fa-clock';
                            let textoEstado = 'Pendiente';
                            
                            switch(actividad.estado) {
                                case 'completada':
                                    colorEstado = '#2ecc71';
                                    iconoEstado = 'fa-check-circle';
                                    textoEstado = 'Completada';
                                    break;
                                case 'en_progreso':
                                    colorEstado = '#3498db';
                                    iconoEstado = 'fa-spinner';
                                    textoEstado = 'En progreso';
                                    break;
                            }
                            
                            return `
                                <div class="item-elemento" onclick="mostrarDetallesActividad(${actividad.id})">
                                    <div class="item-icono" style="background: ${colorEstado}">
                                        <i class="fas ${iconoEstado}"></i>
                                    </div>
                                    <div class="item-info">
                                        <div class="item-titulo">${actividad.nombre}</div>
                                        <div class="item-subtitulo">Estado: ${textoEstado}</div>
                                    </div>
                                </div>
                            `;
                        }).join('')}
                    </div>
                ` : ''}
            </div>
        </div>
        
        <style>
            .info-tactica {
                line-height: 1.6;
                color: rgba(255,255,255,0.9);
            }
            
            .info-tactica p {
                margin-bottom: 15px;
            }
        </style>
    `;
    
    panel.classList.add('open');
}

function mostrarDetallesActividad(actividadId) {
    const actividad = SISTEMA_SOLAR.actividades.find(a => a.id == actividadId);
    if (!actividad) return;
    
    const tactica = SISTEMA_SOLAR.tacticas.find(t => t.id == actividad.tactica_id);
    const estrategia = tactica ? SISTEMA_SOLAR.estrategias.find(e => e.id == tactica.estrategia_id) : null;
    const eje = estrategia ? SISTEMA_SOLAR.ejes.find(e => e.id == estrategia.eje_id) : null;
    
    const panel = document.getElementById('panelDetalles');
    const titulo = document.getElementById('detalleTitulo');
    const contenido = document.getElementById('detalleContenido');
    
    titulo.innerHTML = `<i class="fas fa-meteor"></i> ${actividad.nombre}`;
    
    let colorEstado = '#f39c12';
    let iconoEstado = 'fa-clock';
    let textoEstado = 'Pendiente';
    
    switch(actividad.estado) {
        case 'completada':
            colorEstado = '#2ecc71';
            iconoEstado = 'fa-check-circle';
            textoEstado = 'Completada';
            break;
        case 'en_progreso':
            colorEstado = '#3498db';
            iconoEstado = 'fa-spinner';
            textoEstado = 'En progreso';
            break;
    }
    
    contenido.innerHTML = `
        <div class="detalle-actividad">
            <div class="encabezado-detalle" style="background: linear-gradient(135deg, ${colorEstado}, ${oscurecerColor(colorEstado, 20)});">
                <div class="icono-grande">
                    <i class="fas ${iconoEstado}"></i>
                </div>
                <h3>${actividad.nombre}</h3>
                <p>Actividad</p>
            </div>
            
            <div class="info-actividad">
                <p><strong>Estado:</strong> ${textoEstado}</p>
                ${tactica ? `<p><strong>Táctica:</strong> ${tactica.nombre}</p>` : ''}
                ${estrategia ? `<p><strong>Estrategia:</strong> ${estrategia.nombre}</p>` : ''}
                ${eje ? `<p><strong>Eje:</strong> ${eje.nombre}</p>` : ''}
                
                <div class="jerarquia-actividad">
                    <h4><i class="fas fa-sitemap"></i> Jerarquía</h4>
                    <div class="jerarquia-steps">
                        ${eje ? `<div class="jerarquia-step">
                            <div class="step-icon" style="background: ${eje.color}">
                                <i class="fas fa-${eje.icono}"></i>
                            </div>
                            <div class="step-info">
                                <div class="step-titulo">${eje.nombre}</div>
                                <div class="step-subtitulo">Eje Estratégico</div>
                            </div>
                        </div>` : ''}
                        
                        ${estrategia ? `<div class="jerarquia-step">
                            <div class="step-icon" style="background: #2ecc71">
                                <i class="fas fa-moon"></i>
                            </div>
                            <div class="step-info">
                                <div class="step-titulo">${estrategia.nombre}</div>
                                <div class="step-subtitulo">Estrategia</div>
                            </div>
                        </div>` : ''}
                        
                        ${tactica ? `<div class="jerarquia-step">
                            <div class="step-icon" style="background: #e74c3c">
                                <i class="fas fa-satellite"></i>
                            </div>
                            <div class="step-info">
                                <div class="step-titulo">${tactica.nombre}</div>
                                <div class="step-subtitulo">Táctica</div>
                            </div>
                        </div>` : ''}
                        
                        <div class="jerarquia-step">
                            <div class="step-icon" style="background: ${colorEstado}">
                                <i class="fas ${iconoEstado}"></i>
                            </div>
                            <div class="step-info">
                                <div class="step-titulo">${actividad.nombre}</div>
                                <div class="step-subtitulo">Actividad - ${textoEstado}</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <style>
            .info-actividad {
                line-height: 1.6;
                color: rgba(255,255,255,0.9);
            }
            
            .info-actividad p {
                margin-bottom: 15px;
            }
            
            .jerarquia-actividad {
                background: rgba(255,255,255,0.05);
                border-radius: 10px;
                padding: 15px;
                margin: 20px 0;
            }
            
            .jerarquia-steps {
                margin-top: 15px;
            }
            
            .jerarquia-step {
                display: flex;
                align-items: center;
                gap: 15px;
                margin-bottom: 15px;
            }
            
            .step-icon {
                width: 40px;
                height: 40px;
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                color: white;
                font-size: 18px;
                flex-shrink: 0;
            }
            
            .step-info {
                flex: 1;
            }
            
            .step-titulo {
                font-weight: 600;
                color: white;
                font-size: 14px;
            }
            
            .step-subtitulo {
                font-size: 12px;
                color: rgba(255,255,255,0.7);
                margin-top: 2px;
            }
        </style>
    `;
    
    panel.classList.add('open');
}

function cerrarPanel() {
    document.getElementById('panelDetalles').classList.remove('open');
}

// ================================
// FUNCIONES AUXILIARES
// ================================

function oscurecerColor(color, percent) {
    // Convertir color hex a RGB
    let r = parseInt(color.substr(1, 2), 16);
    let g = parseInt(color.substr(3, 2), 16);
    let b = parseInt(color.substr(5, 2), 16);
    
    // Oscurecer
    r = Math.max(0, Math.floor(r * (100 - percent) / 100));
    g = Math.max(0, Math.floor(g * (100 - percent) / 100));
    b = Math.max(0, Math.floor(b * (100 - percent) / 100));
    
    // Convertir de vuelta a hex
    return `#${r.toString(16).padStart(2, '0')}${g.toString(16).padStart(2, '0')}${b.toString(16).padStart(2, '0')}`;
}

// Iniciar animaciones al cargar
window.addEventListener('load', function() {
    iniciarOrbitasPlanetas();
});
</script>
{% endblock %}
